
<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Warenkorb - Boxology</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root{--navy:#0a2342;--gold:#d4af37;--white:#fff;--light-gray:#f1f1f1}
    body{font-family:Montserrat, sans-serif;background:var(--light-gray);margin:0;color:#222}
    .container{max-width:1000px;margin:40px auto;padding:20px}
    header{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}
    a.logo{font-family:Playfair Display, serif;color:var(--gold);font-size:22px;text-decoration:none}
    .cart-list{background:#fff;padding:20px;border-radius:8px;box-shadow:0 4px 20px rgba(0,0,0,0.05)}
    .cart-item{display:flex;gap:16px;padding:16px 0;border-bottom:1px solid #eee}
    .cart-item:last-child{border-bottom:none}
    .item-img{width:110px;height:80px;flex:0 0 110px;border-radius:6px;object-fit:cover;background:#fafafa}
    .item-meta{flex:1}
    .item-meta h4{margin:0 0 6px}
    .price{font-weight:700}
    .qty{display:flex;align-items:center;gap:8px}
    .qty input{width:60px;padding:8px;text-align:center}
    .summary{margin-top:20px;padding:18px;background:#faf9f6;border-radius:8px}
    .actions{display:flex;gap:12px;justify-content:flex-end;margin-top:18px}
    .btn{background:var(--gold);color:var(--navy);border:none;padding:12px 18px;border-radius:6px;cursor:pointer}
    .btn.secondary{background:#fff;border:1px solid #ddd;color:#333}
    .empty{padding:60px;text-align:center;color:#666}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <a href="index.html" class="logo">Boxology</a>
      <nav>
        <a href="index.html">Shop</a>
      </nav>
    </header>

    <main>
      <h1>Warenkorb</h1>
      <div id="cart-root" class="cart-list">
        <div class="empty">Warenkorb wird geladen …</div>
      </div>
      <div class="actions">
        <button id="clear-cart" class="btn secondary">Warenkorb leeren</button>
        <button id="checkout" class="btn">Zur Kasse</button>
      </div>
    </main>
  </div>

  <script src="assets/cart.js"></script>
  <script>
    // Render cart page using BoxologyCart API
    function formatPrice(n){return '€' + Number(n).toFixed(2).replace('.', ',');}

    function render() {
      const root = document.getElementById('cart-root');
      const cart = window.BoxologyCart.getCart();
      if (!cart || cart.length === 0) {
        root.innerHTML = '<div class="empty">Ihr Warenkorb ist leer. Stöbern Sie in unseren <a href="index.html">Produkten</a>.</div>';
        return;
      }

      let subtotal = 0;
      const html = cart.map(item => {
        const line = (item.price || 0) * (item.qty || 1);
        subtotal += line;
        return `
          <div class="cart-item" data-id="${item.id}">
            <img class="item-img" src="${item.img||''}" onerror="this.style.display='none'" />
            <div class="item-meta">
              <h4>${item.name}</h4>
              <div class="price">Einzelpreis: ${formatPrice(item.price)}</div>
              <div class="qty" style="margin-top:8px">
                <label style="font-size:14px;color:#666">Anzahl</label>
                <input type="number" min="1" value="${item.qty}" class="qty-input" />
                <button class="btn remove" style="background:#fff;border:1px solid #ddd;color:#333;padding:8px 10px;margin-left:8px">Entfernen</button>
              </div>
            </div>
            <div style="min-width:120px;text-align:right">
              <div style="font-weight:700">${formatPrice(line)}</div>
            </div>
          </div>`;
      }).join('');

      root.innerHTML = html + `
        <div class="summary">
          <div style="display:flex;justify-content:space-between;font-weight:700">
            <div>Zwischensumme</div>
            <div id="subtotal">${formatPrice(subtotal)}</div>
          </div>
          <div style="display:flex;justify-content:space-between;margin-top:8px;color:#2d7a30">
            <div>Versand</div>
            <div>Kostenlos</div>
          </div>
          <div style="display:flex;justify-content:space-between;margin-top:10px;font-size:1.25rem">
            <div>Gesamtsumme</div>
            <div id="total">${formatPrice(subtotal)}</div>
          </div>
        </div>`;

      // wire qty and remove buttons
      root.querySelectorAll('.cart-item').forEach(el => {
        const id = el.dataset.id;
        const input = el.querySelector('.qty-input');
        input.addEventListener('change', e => {
          const v = Number(e.target.value || 1);
          if (v < 1) { e.target.value = 1; return; }
          window.BoxologyCart.updateQty(id, v);
          render();
        });
        el.querySelector('.remove').addEventListener('click', () => {
          window.BoxologyCart.removeFromCart(id);
          render();
        });
      });
    }

    document.addEventListener('DOMContentLoaded', () => {
      render();
      document.getElementById('clear-cart').addEventListener('click', () => {
        if (!confirm('Warenkorb wirklich leeren?')) return;
        window.BoxologyCart.clearCart();
        render();
      });
      document.getElementById('checkout').addEventListener('click', () => {
        // simple stub - in a real site you'd go to checkout flow
        alert('Weiter zur Kasse (Demo) — Implementieren Sie Ihre Zahlungs- / Bestell-Integration.');
      });
    });
  </script>
</body>
</html>
